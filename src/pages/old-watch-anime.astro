---
import Layout from '../layouts/Layout.astro';
import ListPageLayout from '../components/ListPageLayout.astro';
import { OldWatchAnimes } from '../lib/anime-list';
---

<Layout 
  title="今まで視聴したアニメ一覧 - @tonosaki"
  description="今まで視聴したアニメの一覧です。"
>
  <ListPageLayout
    title="今まで視聴したアニメ一覧"
    backHref="/"
    backLabel="← ホームに戻る"
    description="今まで視聴したアニメの一覧です。"
  >
    <form class="max-w-md" onsubmit="event.preventDefault();">
      <label class="block text-sm font-medium text-gray-700 dark:text-gray-300" for="anime-search">
        アニメ名で検索
      </label>
      <input
        id="anime-search"
        type="text"
        placeholder="タイトルを入力"
        class="mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-700 px-3 py-2 text-sm text-gray-900 dark:text-gray-100 focus:border-gray-500 focus:outline-none focus:ring-1 focus:ring-gray-500"
      />
    </form>

    <ul id="anime-list" class="space-y-3 mt-6">
      {OldWatchAnimes.map((anime) => (
        <li class="flex items-center justify-between gap-2 px-4 py-2 w-full border border-gray-300 dark:border-gray-700 rounded-md text-black dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
          <span>{anime}</span>
        </li>
      ))}
    </ul>
  </ListPageLayout>
</Layout>

<script>
  if (typeof window !== 'undefined') {
    const input = document.getElementById('anime-search');
    const list = document.getElementById('anime-list');

    if (input instanceof HTMLInputElement && list) {
      const items = Array.from(list.querySelectorAll('li'));

      input.addEventListener('input', () => {
        const query = input.value.toLowerCase();

        items.forEach((item) => {
          const text = item.textContent?.toLowerCase() ?? '';
          item.style.display = text.includes(query) ? '' : 'none';
        });
      });
    }
  }
</script>


